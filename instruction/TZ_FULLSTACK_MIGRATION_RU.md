# Техническое Задание (ТЗ) на разработку Full-Stack ERP системы

## 1. Введение и Цель

**Текущее состояние:** Проект представляет собой набор статических HTML/JS файлов. Вся база данных хранится в `localStorage` браузера.
**Проблема (Ограничение):** Данные не синхронизируются. Если менеджер работает на своем ноутбуке, а кладовщик на своем — они видят **разные** базы данных. При очистке кеша браузера данные теряются безвозвратно.
**Цель:** Разработать полноценное веб-приложение (Client-Server), где все данные хранятся на центральном сервере, а пользователи имеют доступ к актуальной информации с любого устройства в режиме реального времени.

---

## 2. Архитектура Системы

Система должна быть разделена на две независимые части (Frontend и Backend), общающиеся через API.

```
[Браузер (Frontend)]  <-- Интернет (HTTPS) -->  [Сервер (Backend/API)]  <---->  [База Данных]
   (React / Vue)                                (Node.js / Python)             (PostgreSQL)
```

### 2.1. Frontend (Клиентская часть)

* **Задача:** Отображение интерфейса и отправка запросов на сервер.
* **РЕКОМЕНДУЕМЫЙ СТЕК:**
  * **React (Vite):** Современный стандарт разработки. Быстрый, удобный, легко масштабируется.
* **Хостинг:** **Vercel** (Лучшая платформа для React приложений).

### 2.2. Backend (Серверная часть)

* **Задача:** Обработка бизнес-логики, проверка прав доступа, сохранение данных в базу.
* **РЕКОМЕНДУЕМЫЙ СТЕК (Оптимально):**
  * **Node.js + Express:** Самый простой и популярный вариант для старта. Использует JavaScript, как и фронтенд.
  * **Prisma ORM:** Современный инструмент для удобной работы с базой данных.
* **Хостинг:** **Railway** (Идеально подходит для Node.js и PostgreSQL).

### 2.3. База Данных (Storage)

* **Задача:** Надежное хранение данных.
* **РЕКОМЕНДУЕМЫЙ СТЕК:** **PostgreSQL**. Надежная, мощная, легко разворачивается на Railway.

---

## 3. Структура Базы Данных (Схема)

Необходимо создать следующие таблицы в PostgreSQL (замена `storage.js`):

### 3.1. Основные справочники

1. **users** (Пользователи)
    * `id` (UUID/Integer)
    * `username` (Login)
    * `password_hash` (Хеш пароля, не хранить в открытом виде!)
    * `role` (admin, manager, production, picker, delivery)
    * `is_active` (Boolean)

2. **suppliers** (Поставщики)
    * `id`, `name`, `status`

3. **customers** (Клиенты/Точки)
    * `id`, `name`, `route_order` (порядок в маршруте), `status`

4. **products** (Товары)
    * `code` (SKU), `name`, `unit` (кг/шт), `category`
    * `price_base` (базовая цена)

### 3.2. Операционные таблицы

1. **orders** (Заказы)
    * `id`
    * `customer_id` (FK -> customers)
    * `date` (дата доставки)
    * `status` (new, processed, shipped)
    * `created_at`, `updated_at`

2. **order_items** (Состав заказа)
    * `id`
    * `order_id` (FK -> orders)
    * `product_code` (FK -> products)
    * `qty` (количество)
    * `price` (цена фикс)

3. **purchases** (Закупки у поставщиков)
    * `id`, `supplier_id`, `date`, `status`

4. **stock** (Остатки на складе)
    * `product_code`, `qty_on_hand` (текущий остаток)

---

## 4. API Эндпоинты (Примеры)

Сервер должен предоставлять следующие URL для Frontend-а:

### Аутентификация

* `POST /api/auth/login` — Вход (возвращает JWT токен).
* `GET /api/auth/me` — Получить данные текущего юзера.

### Товары

* `GET /api/products` — Список товаров.
* `POST /api/products` — Создать товар.
* `PUT /api/products/:code` — Обновить товар.

### Заказы

* `GET /api/orders?date=2023-10-27` — Получить заказы на дату.
* `POST /api/orders` — Создать новый заказ.
* `PATCH /api/orders/:id/status` — Изменить статус (напр. "Собран").

---

## 5. План миграции (Пошагово)

### Этап 1: Подготовка Бэкенда

1. Развернуть базу данных **PostgreSQL** (локально или в облаке, например Neon/Supabase).
2. Создать Node.js проект (например, на **NestJS**).
3. Описать сущности (User, Product, Order) и создать миграции для БД.
4. Реализовать API для Авторизации (Login).

### Этап 2: Замена `storage.js`

1. На Фронтенде создать новый файл `apiService.js` (вместо `storage.js`).
2. В этом файле все методы `getProducts()`, `saveProducts()` переписать так, чтобы они делали `fetch('https://api.mysite.com/products')`.
3. **Важно:** Убрать всю логику сохранения в `localStorage`.

### Этап 3: Тестирование и Запуск

1. Запустить Бэкенд на сервере (Railway/VPS).
2. Запустить Фронтенд (Vercel/Cloudflare).
3. Проверить:
    * Менеджер заходит с ноутбука, создает заказ.
    * Кладовщик заходит с телефона — **видит этот заказ мгновенно**.

---

## 6. Что нужно изучить/нанять

Если вы делаете это самостоятельно, вам понадобятся навыки:

1. **SQL** (язык запросов к базе данных).
2. **Node.js / Express** (как создать сервер).
3. **Authentication (JWT)** (как безопасно делать логин).
4. **Deployment** (как настроить сервер Linux или Docker контейнеры).
